<!--A Design by W3layouts
Author: W3layout
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE html class="h-100">

<head>
    <title>Thống kê món ăn</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="Visitors Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template, 
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
    <script type="application/x-javascript">
        addEventListener("load", function () {
            setTimeout(hideURLbar, 0);
        }, false);

        function hideURLbar() {
            window.scrollTo(0, 1);
        }
    </script>
    <!-- Custom CSS -->
    <link href="../../css/bootstrap.min.css" rel='stylesheet' type='text/css'>
    <link href="../../css/style.css" rel='stylesheet' type='text/css' />
    <link href="../../css/style-responsive.css" rel="stylesheet" />
    <!-- font CSS -->
    <link
        href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic'
        rel='stylesheet' type='text/css'>
    <!-- font-awesome icons -->
    <link rel="stylesheet" href="../../css/font.css" type="text/css" />
    <link href="../../css/font-awesome.css" rel="stylesheet">
    <!-- //font-awesome icons -->
    <link href="../../css/skdslider.css" rel="stylesheet">
    <style>
        html {
            overflow: hidden;
        }
    </style>
</head>

<body class="h-100">
    <section id="container" class="">
        <!--header start-->
        <header class="header fixed-top clearfix">
            <!--logo start-->
            <div class="brand">

                <a href="index.html" class="logo">
                    LOGO
                </a>
                <div class="sidebar-toggle-box">
                    <div class="fa fa-bars"></div>
                </div>
            </div>
            <!--logo end-->
            <div class="row">
                <div class="h1 text-info mt-3 ml-sm-5 ten-nha-hang">Tên nhà hàng ABC</div>
                <div class="top-nav ml-auto clearfix">
                    <!--search & user info start-->
                    <ul class="nav pull-right top-menu">

                        <!-- user login dropdown start-->
                        <li class="dropdown mt-1">
                            <a data-toggle="dropdown" class="dropdown-toggle py-2 px-1" href="#">
                                <img alt="" src="../../images/2.png">
                                <span class="username">John Doe</span>
                                <b class="caret"></b>
                            </a>
                            <ul class="dropdown-menu extended logout">
                                <li><a href="#"><i class=" fa fa-suitcase"></i>Tài khoản</a></li>
                                <li><a href="login.html"><i class="fa fa-key"></i>Đăng Xuất</a></li>
                            </ul>
                        </li>
                        <!-- user login dropdown end -->

                    </ul>
                    <!--search & user info end-->
                </div>
            </div>

        </header>
        <!--header end-->
        <!--sidebar start-->
        <aside>
            <div id="sidebar" class="nav-collapse">
                <!-- sidebar menu start-->
                <div class="leftside-navigation">
                    <ul class="sidebar-menu" id="nav-accordion">

                        <li>
                            <a href="san_pham.html">
                                <i class="fa fa-book"></i>
                                <span>Sản phẩm</span>
                            </a>
                        </li>
                        <li>
                            <a href="hoa_don.html">
                                <i class="fa fa-book"></i>
                                <span>Hóa đơn</span>
                            </a>
                        </li>
                        <li class="sub-menu">
                            <a href="javascript:;">
                                <i class="fa fa-th"></i>
                                <span>Thống kê</span>
                            </a>
                            <ul class="sub">
                                <li><a href="thong_ke_mon_an.html">Món ăn</a></li>
                                <li><a href="thong_ke_hoa_don.html">Hóa đơn</a></li>
                            </ul>
                        </li>

                    </ul>
                </div>
                <!-- sidebar menu end-->
            </div>
        </aside>
        <!--sidebar end-->
        <!--main content start-->

        <section id="main-content" class="h-100">
            <section class="wrapper container-fluid h-100">
                <!-- page start-->
                <div class="text-center">
                    <div class="mt-3 d-inline-block  text-center">
                        <div class="form-group float-left mr-2 d-block">
                            <label for=""><strong>Từ ngày</strong></label>
                            <input type="date" class="form-control px-0" name="" id="dateFrom">
                        </div>
                        <div class="form-group float-left ml-2">
                            <label for=""><strong>Đến ngày</strong></label>
                            <input type="date" class="form-control px-0" name="" id="dateTo">
                        </div>

                    </div>

                </div>
                <div class="text-center mb-3">
                    <button id="btn_tim" class="btn btn-group-lg btn-success"><i class="fa fa-search">
                            Tìm</i></button>
                </div>
                <div class="row h-75">
                    <div class="col-sm-12 px-0" id="Th_Bieu_do"></div>
                </div>

                <!-- page end-->

            </section>
        </section>
        <!--main content end-->
    </section>

    <script src="../../js/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous">
    </script>
    <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/jquery.dcjqaccordion.2.7.js"></script>
    <script src="../../js/scripts.js"></script>

    <script src="../../js/jquery.slimscroll.js"></script>
    <script src="../../js/jquery.nicescroll.js"></script>
    <!--[if lte IE 8]><script language="javascript" type="text/javascript" src="../../js/flot-chart/excanvas.min.js"></script><![endif]-->
    <script src="../../js/jquery.scrollTo.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="../../Xu_ly/Xu_ly_3L_quan_tri.js"></script>

    <script>
        dateFrom.value = new Date(Date.now()).toISOString().split('T')[0]
        dateTo.value = new Date(Date.now()).toISOString().split('T')[0]

        function tinh_so_luong(Danh_sach) {
            var so_luong = 0;
            Danh_sach.forEach(row => {
                so_luong += row.so_luong;
            });
            return so_luong;
        }
        btn_tim.onclick = async () => {
            var ds;
            var arrmonan = [];
            var arrsoluong = [];
            var ds_mon_an = await Doc_ds_san_pham();
            var ds_hoa_don;
            var from = new Date(dateFrom.value)
            var to = new Date(dateTo.value)
            to.setDate(to.getDate() + 1)
            Doc_ds_hoa_don().then(res => {
                ds_hoa_don = res.filter(x => x.ngay_lap >= dateFrom.value).filter(x => x.ngay_lap <= to
                    .toISOString().split(
                        'T')[0])
                ds_mon_an.forEach(row => {
                    arrmonan.push(row.Ten);
                    var so_luong = 0;
                    ds_hoa_don.forEach(hd => {
                        hd.chi_tiet.forEach(ct => {
                            if (ct.ma_sp == row.Ma_so) {
                                so_luong += Number(ct.so_luong);
                            }
                        });
                    });
                    arrsoluong.push(so_luong);
                });
                arrmonan.pop();
                arrsoluong.pop();
                Highcharts.chart('Th_Bieu_do', {
                    chart: {
                        type: 'column', // bar , column, line, pie
                        plotBorderWidth: 1
                    },
                    title: {
                        text: 'Thống kê món ăn',
                        align: 'center',
                        style: {
                            color: 'red',
                            fontWeight: 'bold',
                            fontSize: '1.5rem'
                        },
                        y: 20
                    },
                    subtitle: {
                        text: `từ ${dateFrom.value} đến ${dateTo.value}`
                    },
                    xAxis: {
                        categories: arrmonan
                    },
                    yAxis: {
                        title: {
                            text: 'Tổng số lượng bán',

                            style: {
                                color: 'blue',
                                fontWeight: 'bold',
                                fontSize: '1rem'
                            }

                        }
                    },
                    series: [{
                        name: 'Số lượng',
                        data: arrsoluong,
                        color: 'red'
                    }]

                });
            })
        }

        Highcharts.setOptions({
            lang: {
                numericSymbols: [` Ngàn`, ` Triệu`],
                numericSymbolMagnitude: 1000,
                decimalPoint: ',', ///phân cách thập phân
                thousandsSep: '.' ///hàng ngàn
            },
            chart: {
                style: {
                    fontFamily: `tahoma`, /// chỉnh font cho chữ thống dc đúng
                    fontSize: 16
                }
            }
        })
        btn_tim.click();
    </script>
</body>

</html>